import{d as W,c as x,u as Z,r as n,a as $,b as G,w as L,e as s,f as r,g as N,_ as I,h as R,i as S,j as i,t as V,k as y,v as k,l as J,o as b,m as q}from"./index-CW84L7Dy.js";import{W as H}from"./WaterMark-BgblRerj.js";import{L as v}from"./LineEdit-D2N9ICyw.js";const K={class:"auth-layout"},Q={class:"auth-content"},X={class:"right-form"},Y={class:"to-login"},h={key:0,class:"message error"},_={key:1,class:"message success"},ee={class:"form-group"},se={class:"control-panel"},ae=["disabled"],le=W({__name:"SignUpView",setup(te){const B=Z(),E=J(),F=x(()=>B.meta.watermark_text),u=n(""),d=n(""),m=n(""),g=n(""),o=n("male");n("已禁用字段的值");const w=n(!1),c=n(!1),M=n(!1),C=n(!1),t=$({isLoading:!1,errorMessage:"",successMessage:""}),P=a=>a.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?{isValid:!0}:{isValid:!1,message:"邮箱格式不正确"}:{isValid:!1,message:"邮箱不能为空"},T=a=>a.trim()?a.length<6?{isValid:!1,message:"密码长度至少6位"}:a.length>18?{isValid:!1,message:"密码长度至多18位"}:/[A-Z]/.test(a)?/\d/.test(a)?{isValid:!0}:{isValid:!1,message:"密码必须包含数字"}:{isValid:!1,message:"密码必须包含大写字母"}:{isValid:!1,message:"密码不能为空"},j=a=>a.trim()?a.length<3?{isValid:!1,message:"用户名长度至少3位"}:a.length>20?{isValid:!1,message:"用户名长度不能超过20位"}:/^[a-zA-Z0-9_]+$/.test(a)?{isValid:!0}:{isValid:!1,message:"用户名只能包含字母、数字和下划线"}:{isValid:!1,message:"用户名不能为空"},D=a=>a.trim()?a.length<2?{isValid:!1,message:"昵称长度至少2位"}:a.length>12?{isValid:!1,message:"昵称长度不能超过12位"}:{isValid:!0}:{isValid:!1,message:"昵称不能为空"},p=(a,e)=>{a==="email"?w.value=e:a==="password"?c.value=e:a==="username"?M.value=e:a==="nickname"&&(C.value=e)},U=x(()=>w.value&&c.value&&M.value&&C.value),O=async()=>{if(t.errorMessage="",t.successMessage="",!U.value){t.errorMessage="请完善表单信息";return}const a={username:m.value,nickname:g.value,password:d.value,email:u.value,gender:o.value==="male"?"男":o.value==="female"?"女":"保密"};try{t.isLoading=!0;const e=await fetch("/api/users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),f=await e.json();e.ok?(t.successMessage=f.message||"注册成功！",setTimeout(()=>{E.push("/login")},2e3)):t.errorMessage=f.message||"注册失败，请稍后重试"}catch(e){console.error("注册请求失败:",e),t.errorMessage="网络错误，请检查网络连接"}finally{t.isLoading=!1}},z=()=>{u.value="",d.value="",m.value="",g.value="",o.value="male",t.errorMessage="",t.successMessage=""};return(a,e)=>{const f=N("router-view"),A=N("router-link");return b(),G(H,{text:F.value,fontSize:18,fontColor:"#0963FF",opacity:.5,rotate:-30},{default:L(()=>[s("div",K,[s("main",Q,[r(f),e[27]||(e[27]=s("div",{class:"left-form"},[s("h1",null,"创建你的账号"),s("img",{src:I,alt:"logo"})],-1)),s("div",X,[s("div",Y,[s("p",null,[e[12]||(e[12]=i("已经有账号了？",-1)),r(A,{to:"/login"},{default:L(()=>[...e[11]||(e[11]=[i("登录",-1)])]),_:1})])]),e[26]||(e[26]=s("div",{class:"title"},[s("h3",null,"注册账号")],-1)),t.errorMessage?(b(),R("div",h,V(t.errorMessage),1)):S("",!0),t.successMessage?(b(),R("div",_,V(t.successMessage),1)):S("",!0),s("div",ee,[r(v,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),label:"Email*",placeholder:"邮箱",type:"email",validator:P,"validate-on-input":"",onValidityChange:e[1]||(e[1]=l=>p("email",l))},null,8,["modelValue"]),e[21]||(e[21]=s("p",null,null,-1)),r(v,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value=l),label:"Password*",placeholder:"密码",type:"password",validator:T,onValidityChange:e[3]||(e[3]=l=>p("password",l))},null,8,["modelValue"]),e[22]||(e[22]=s("p",null,"Password should be at least 18 characters OR at least 6 characters including a number and a uppercase letter.",-1)),r(v,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=l=>m.value=l),label:"Username*",placeholder:"用户名",validator:j,onValidityChange:e[5]||(e[5]=l=>p("username",l))},null,8,["modelValue"]),e[23]||(e[23]=s("p",null,"Username may only contain alphanumeric characters or single hyphens, and cannot begin or end with a hyphen.",-1)),r(v,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]=l=>g.value=l),label:"Nickname*",placeholder:"昵称",validator:D,onValidityChange:e[7]||(e[7]=l=>p("nickname",l))},null,8,["modelValue"]),e[24]||(e[24]=s("p",null,null,-1)),s("div",null,[e[13]||(e[13]=s("label",{class:"edit-label"},"Gender*",-1)),e[14]||(e[14]=s("br",null,null,-1)),y(s("input",{type:"radio",id:"male",name:"gender",value:"male","onUpdate:modelValue":e[8]||(e[8]=l=>o.value=l),checked:""},null,512),[[k,o.value]]),e[15]||(e[15]=s("label",{for:"male",style:{color:"black"}},"男",-1)),e[16]||(e[16]=i("   ",-1)),y(s("input",{type:"radio",id:"female",name:"gender",value:"female","onUpdate:modelValue":e[9]||(e[9]=l=>o.value=l)},null,512),[[k,o.value]]),e[17]||(e[17]=s("label",{for:"female",style:{color:"black"}},"女",-1)),e[18]||(e[18]=i("   ",-1)),y(s("input",{type:"radio",id:"unknown",name:"gender",value:"unknown","onUpdate:modelValue":e[10]||(e[10]=l=>o.value=l)},null,512),[[k,o.value]]),e[19]||(e[19]=s("label",{for:"unknown",style:{color:"black"}},"保密",-1))]),e[25]||(e[25]=s("p",null,null,-1)),s("div",se,[s("button",{type:"button",class:"submit-btn",onClick:O,disabled:!U.value||t.isLoading},V(t.isLoading?"注册中...":"注册 >"),9,ae),s("button",{type:"button",class:"reset-btn",onClick:z}," 重置 "),e[20]||(e[20]=s("p",null,[i("创建账号，代表你同意"),s("a",null,"《服务协议》"),i("与"),s("a",null,"《隐私条款》")],-1))])])])])])]),_:1},8,["text"])}}}),ie=q(le,[["__scopeId","data-v-024f5ad0"]]);export{ie as default};

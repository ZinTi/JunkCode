import{d as v,c as y,n as k,y as g,m as b,h as x,e as h,z as S,A as w,o as _}from"./index-CW84L7Dy.js";const M=v({name:"WaterMark",props:{text:{type:String,default:"水印文本示例"},fontSize:{type:Number,default:20},fontColor:{type:String,default:"#000000"},opacity:{type:Number,default:.1,validator:t=>t>=0&&t<=1},rotate:{type:Number,default:-30}},setup(t){const i=()=>{const a=document.createElement("canvas"),e=a.getContext("2d");if(!e)return"";const r=t.fontSize,o=t.text,s=t.rotate;e.font=`${r}px Arial`;const c=e.measureText(o).width,m=Math.max(c+100,300),p=Math.max(r*3,200);a.width=m,a.height=p,e.clearRect(0,0,a.width,a.height),e.font=`${r}px Arial`,e.fillStyle=t.fontColor,e.globalAlpha=t.opacity,e.textAlign="center",e.textBaseline="middle";const u=m/2,f=p/2;return e.translate(u,f),e.rotate(s*Math.PI/180),e.fillText(o,0,0),e.rotate(-s*Math.PI/180),e.translate(-u,-f),a.toDataURL("image/png")},l=y(()=>({backgroundImage:`url(${i()})`,backgroundRepeat:"repeat",pointerEvents:"none",zIndex:9999,position:"absolute",top:"0",left:"0",width:"100%",height:"100%"})),d=y(()=>({position:"relative",width:"100%",minHeight:"100px"}));let n=null;return k(()=>{n=new MutationObserver(e=>{e.forEach(r=>{if(r.type==="childList"&&r.removedNodes.forEach(o=>{if(o.classList?.contains("watermark-overlay")){const s=document.querySelector(".watermark-wrapper");if(s){const c=document.createElement("div");c.className="watermark-overlay",Object.assign(c.style,l.value),s.appendChild(c)}}}),r.type==="attributes"&&r.target.classList?.contains("watermark-overlay")){const o=r.target;Object.assign(o.style,l.value)}})});const a=document.querySelector(".watermark-overlay");if(a){n.observe(a,{attributes:!0,attributeFilter:["style","class"]});const e=document.querySelector(".watermark-wrapper");e&&n.observe(e,{childList:!0})}}),g(()=>{n&&n.disconnect()}),{watermarkStyle:l,wrapperStyle:d}}}),$={class:"content-slot"};function E(t,i,l,d,n,a){return _(),x("div",{class:"watermark-wrapper",style:w(t.wrapperStyle)},[h("div",$,[S(t.$slots,"default",{},void 0)]),h("div",{class:"watermark-overlay",style:w(t.watermarkStyle)},null,4)],4)}const z=b(M,[["render",E],["__scopeId","data-v-0719dcca"]]);export{z as W};
